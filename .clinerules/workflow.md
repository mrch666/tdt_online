# Правила рабочего процесса (Workflow Rules)

## Основное правило: Одна ошибка - одно исправление

### 1. Принцип минимальных изменений
- **Исправлять только 1 файл** в одном месте при ошибках
- **Не вносить глобальные изменения** в `.env`, структуру проекта и другие файлы
- **Не делать одновременно много изменений** - только то, что необходимо для исправления конкретной ошибки

### 2. Фокус на одной ошибке
- Работаем только над **1 ошибкой за раз**
- Изменения должны быть **локализованы в 1 месте (файле)**
- **Никакое изменение не должно порождать больше ошибок**, чем сейчас

### 3. Тестирование перед исправлением
Для каждой ошибки должен быть создан соответствующий тест:
1. **Тест, который не проходит с данной ошибкой** - подтверждает наличие проблемы
2. **Тест, который проходит после исправления** - подтверждает решение

### 4. Процесс исправления ошибок
```
1. Обнаружение ошибки
   ↓
2. Создание теста, который падает из-за этой ошибки
   ↓
3. Локализация проблемы (определение точного места в коде)
   ↓
4. Минимальное исправление в одном файле
   ↓
5. Создание теста, который проходит после исправления
   ↓
6. Запуск всех предыдущих тестов
   ↓
7. Коммит только после прохождения всех тестов
```

### 5. Правила коммита
- **Перед коммитом должны быть выполнены все предыдущие тесты**
- **Тест, который отлавливает эту ошибку, должен пройти**
- **Коммит только после прохождения всех тестов**
- Сообщение коммита должно четко описывать:
  - Какую ошибку исправляем
  - В каком файле было исправление
  - Какие тесты были созданы/обновлены

### 6. Запрещенные действия
- ❌ Изменение нескольких файлов одновременно
- ❌ Глобальные изменения конфигурации (.env и др.)
- ❌ Рефакторинг, не связанный с исправлением ошибки
- ❌ Добавление новой функциональности при исправлении ошибки
- ❌ Коммит без прохождения всех тестов

### 7. Пример правильного workflow
**Ошибка**: "Value of parameter (0) is too long, expected 12, found 17"

**Правильные действия**:
1. Создать тест `test_modelid_length_error()` который падает с этой ошибкой
2. Найти точное место в коде (например, `app/routers/modelgoods_images.py:120`)
3. Исправить только эту строку
4. Создать тест `test_modelid_length_fixed()` который проходит
5. Запустить все существующие тесты
6. Если все тесты проходят - сделать коммит

**Неправильные действия**:
1. Менять `.env` файл
2. Менять структуру проекта
3. Делать рефакторинг всего файла
4. Добавлять новую функциональность
5. Коммитить без тестов

### 8. Контроль качества
- Каждое исправление должно быть **минимальным и целевым**
- **Не создавать новых зависимостей** между изменениями
- **Сохранять обратную совместимость**
- **Документировать изменения** в тестах и комментариях к коду